define("wkview:widget/raw_income/native_income/native_income.js",function(t,i,e){var a=t("wkcommon:widget/ui/lib/jquery/jquery.js"),s=t("wkcommon:widget/lib/tangram/base/base.js"),n=t("wkcommon:widget/ui/js_core/_dialog/_dialog.js"),o=t("wkcommon:widget/lib/doT/doT.min.js"),c=t("wkview:widget/raw_income/raw_income.js"),l=t("wkcommon:widget/ui/js_core/log/log.js"),d=(t("wkview:widget/html_view/html_reader/js/page.js").page,t("wkcommon:widget/ui/js_core/xform/xform.js")),p=function(){this.option={},this.cacheList="",this.video="",this.cacheData={},this.downloadTpl=o.template('<!-- htmlcs-disable -->\n{{? it.list == 1 }}\n<div class="ads-doc-list">\n    <div class="header">\n        <div class="myclose"></div>\n        <div class="close list-close-btn"></div>\n        <h2>{{= it.data.title}}</h2>\n        <p>\u5171<span class="counter">{{= it.data.doc_list.length}}</span>\u7bc7\u6587\u6863&nbsp;&nbsp;{{= it.data.count}}\u4eba\u5df2\u4e0b\u8f7d</p>\n        </div>\n    <div class="cont" id="cont">\n        <ul class="list dialog-list">\n            {{if (it.data && it.data.doc_list.length >0) {}}\n            {{for(var i=0;i< it.data.doc_list.length;i++) {}}\n            <li><span class="number">{{=i+1}}</span> <span class="ic ic-{{=it.data.doc_list[i].type}}"></span>{{=it.data.doc_list[i].title}}</li>\n            {{}}}\n            {{ } }}\n        </ul>\n        <a href="###" class="ui-bz-btn-senior native-ads-download-btn">\n            <b class="ui-bz-btn-p-40 ui-bz-btc ">\u514d\u8d39\u4e0b\u8f7d</b>\n            </a>\n        </div>\n    <div class="public-tip">{{= it.data.advertiser}} <span class="private">\u9690\u79c1\u4fdd\u969c<div class="hover-tip-hujiang"><span class="arrow-icon"></span>{{= it.data.privacy_policy}}</div></span></div>\n    </div>\n{{?? it.list == 0}}\n<div class="download-success-dialog">\n    <div class="myclose"></div>\n    <div class="close success-close-btn"></div>\n    <div class="dialog-left-greenbar"></div>\n    <div class="dialog-top">\n        <p class="doc-title" rel="new-dialog" alt="dialog_tit">{{=it.tmpdata.title}}</p>\n        </div>\n    <div class="dialog-inner tac">\n        <img class="ui-bz-avatar ui-bz-avatar-60-60" src="{{=it.tmpdata.step3.download_image}}" alt="" >\n        <p class="success">{{=it.tmpdata.step3.download_wenan}}\n            <a href="{{=it.tmpdata.step3.third_url}}" target="_blank" class="outlink log-xsend" data-logxsend="[1, 100897]">{{=it.tmpdata.step3.third_name}}</a>\n        </p>\n        </div>\n    <div class="public-tip">{{=it.tmpdata.advertiser}} <span class="private">\u9690\u79c1\u4fdd\u969c<div class="hover-tip-hujiang"><span class="arrow-icon"></span>{{=it.tmpdata.privacy_policy}}</div></span>\n        </div>\n    </div>\n{{?? it.list == 2}}\n    <div class="video-con">\n        <span class="myclose"></span>\n        <span class="video-close"></span>\n        <div class="header clearfix">\n            <span class="green-icon"></span><p class="video-title">{{= it.options.title}}</p><span class="video-size">&nbsp;(\u8bd5\u770b3\u5206\u949f)</span>\n        </div>\n        <div class="video" id="video">\n            \n        </div>\n        <div class="temp" style="display: none;">\n            <div class="video-wrap">\n\n            </div>\n            <p class="wenan">\u9884\u89c8\u7ed3\u675f</p>\n            <a href="{{= it.options.button_url}}" class="wrap-button" target="_blank">\u67e5\u770b\u5b8c\u6574\u89c6\u9891</a>\n        </div>\n        <div class="foot">\n            <img src="{{= it.options.video_img}}" alt="" class="video-jigou-icon">\n            <div class="content">\n                <div class="content-title">\n                    <span class="jigou-name">{{= it.options.release_user}}</span>&nbsp;\u63d0\u4f9b\u672c\u89c6\u9891\n                </div>\n                <p class="jigou-miaosu">{{= it.options.abstract}}</p>\n                <div class="video-tail-info">\n                    <span class="people-num">{{= it.options.view_count}}</span>\u4eba\u5df2\u89c2\u770b&nbsp;&nbsp;{{= it.options.section}}\n                </div>\n            </div>\n            <a href="{{= it.options.button_url}}"  target="_blank" title="" class="video-button">\u67e5\u770b\u5b8c\u6574\u89c6\u9891</a>\n        </div>\n    </div>\n{{?}}'),this.cacheData.downloadTpl=this.downloadTpl,this.init()};p.prototype={init:function(){var t=(a("head"),document.createElement("script"));t.src="//tob-cms.bj.bcebos.com/v1/pc/jwplayernew.js",t.charset="utf-8",a("head").append(t);var i=this;i.bindEvent(),window.oRawIncome=new c(i.cacheData)},initVideo:function(t){var i=this;a("#video").show(),jwplayer("video").setup({flashplayer:"http://webkk.chuanke.com/player/player_enc.swf",anthology:!0,playlist:[{file:t.video_file,provider:"enc",type:"flv",key:t.video_key}],uid:"0",seekheader:!0,quickseek:!0,icons:!0,bufferlength:"10",type:"http",streamer:"start",autostart:!0,width:894,height:504,events:{onError:function(){console.log("onError"),l.xsend(1,100929,{ac_id:i.tempOptions.ad_id})},onReady:function(){console.log("onReady")},onTime:function(t){console.log("onTime:",t.position,t.duration),t.position>180?(jwplayer("video").getFullscreen&&jwplayer("video").setFullscreen("false"),this.pause(),a(".temp").show()):a(".temp").hide()},onPlay:function(){console.log("onplay")},onPause:function(){console.log("onPause")},onComplete:function(){console.log("onComplete")},onPlaylistItem:function(){console.log("onPlaylistItem")},onPlaylistComplete:function(){console.log("onPlaylistComplete")},onBufferFull:function(){console.log("onbufferfull")}}})},showDialog:function(t,i){this.tempOptions=i;var e=this;if(1==t){var o=this.getData(i);if(o){var c={};c.doc_list=e.cacheList,c.title=e.cacheData.title,c.advertiser=e.cacheData.advertiser,c.privacy_policy=e.cacheData.privacy_policy,c.count=e.cacheData.count;var l=n.customDialog;a(".ys-ads-mask").show(),new l({width:464,height:564,content:e.downloadTpl({list:1,data:c}),closeSelector:".myclose",mask:{bgColor:"transparent"}})}}else if(2==t){e.tempTime=Date.parse(new Date);var l=n.customDialog;a(".ys-ads-mask").show(),s.event.un(document,"keydown"),new l({width:896,height:703,content:e.downloadTpl({list:2,options:i}),closeSelector:".myclose",mask:{bgColor:"transparent"}}),e.initVideo(i)}},bindEvent:function(){var t=this;a("body").on("click",".success-close-btn, .list-close-btn",function(){a(".myclose").trigger("click"),a(".ys-ads-mask").hide()}),a("body").on("click",".video-close",function(){l.xsend(1,100912,{ac_id:t.tempOptions.ad_id,res_time:Date.parse(new Date)-t.tempTime}),a(".myclose").trigger("click"),a(".ys-ads-mask").hide(),a(window).trigger("videoClose")}),a("body").on("click",".native-ads-download-btn",function(){a(".myclose").trigger("click"),window.oRawIncome.showDialog(),l.xsend(1,100895,{id:t.option.ad_id})}),a("body").on("click",".video-button",function(){l.xsend(1,100913,{ac_id:t.tempOptions.ad_id,res_time:Date.parse(new Date)-t.tempTime})}),a("body").on("click",".wrap-button",function(){l.xsend(1,100914,{ac_id:t.tempOptions.ad_id,res_time:Date.parse(new Date)-t.tempTime})}),a("body").on("keyup",function(t){27==t.keyCode&&(a(".myclose").trigger("click"),a(".ys-ads-mask").hide(),a(window).trigger("videoClose"))}),a("body").on("click",".success a",function(){l.xsend(1,100897,{id:t.option.ad_id})})},getData:function(t){var i=this;return i.cacheList?!0:(d.getJSON(t.xpageId,{success:function(e){var s=n.customDialog;i.cacheData.title=e.model.step1.title,i.cacheData.step2=e.model.step2,i.cacheData.step3=e.model.step3,i.cacheData.advertiser=e.model.step1.advertiser,i.cacheData.privacy_policy=e.model.step1.privacy_policy,i.cacheData.download_tips=e.model.step1.download_tips,i.cacheData.adId=t.adId,i.cacheData.count=t.count,i.cacheList=e.model.step1.doc_list,e.model.step1.count=t.count,a(".ys-ads-mask").show(),new s({width:464,height:564,content:i.downloadTpl({list:1,data:e.model.step1}),closeSelector:".myclose",mask:{bgColor:"transparent"}})}}),!1)}},e.exports=p});